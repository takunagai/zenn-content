---
title: "「gog」導入・設定ガイド ーー AIに言葉で指示して Googleサービス(Gmail/カレンダー etc.)を操る"
emoji: “🐸"
type: "tech"
topics: ["gog", "cli", "aiエージェント", "google", "gmail"]
published: true
---

![gogでGmailのメールを条件付きで取得](/images/gog-cli-setup-guide/01.jpg)

「来週の空き時間は？」「メールを要約して」。
AIエージェントにそう話しかけるだけで、Google Workspaceを直接操作できたら便利ですよね。

通常なら面倒なAPI実装が必要ですが、CLIツール **[gog (gogcli)](https://gogcli.sh/)** を使えば驚くほど簡単に実現できます。
AIにこのツールを「手足」として渡すだけ。複雑なコードを書くことなく、あなたのエージェントがGmailやカレンダーを自在に操れるようになります。

この記事では、AIエージェントに Google Workspace を自在に操らせることを簡単に実現する `gog` の導入手順を紹介します。実際に私がハマったポイント（認証設定やコマンドの癖）を回避する方法もメモしています。

## gog で操作できる主なサービス

* **Gmail**: メールの検索・送信、ラベルやフィルタの管理
* **Calendar**: 予定のリスト化・作成・更新、空き状況の確認
* **Drive**: ファイルの検索、アップロード・ダウンロード、権限設定
* **Sheets / Docs / Slides**: シートの読み書き、PDFやOffice形式への変換エクスポート
* **Contacts / People**: 個人連絡先やディレクトリの参照
* **Tasks**: タスクリストの管理（追加・完了・削除）

:::message
**Tips**
* 確実に gog を使用させたい場合は `gog スキルを使って` と指示
* Planモードで `AskUserQuestion` 付きで指示するのがおすすめ。実行前に気の利いた確認を入れてくれる

例: `gog スキルを使ってUdemy からのプロモーション関連の内容のメールを履歴を遡って全て削除して。購入関連やコースの修了証関連の削除は禁止。削除したメールの件名をリストで表示して。不明点や選択肢がある場合は AskUserQuestion で確認して`

:::

### 📩 Gmail：メール処理の自動化

* `未読の重要なメールだけ要約して教えて`
* `〇〇さんからの最新メールに対して、肯定的な返信ドラフトを書いて`
* `件名に「請求書」か「領収書」が含まれるメールを過去1ヶ月分リストアップして`
* `Amazonからの発送通知メールを検索して、到着予定日を教えて`
* `「プロモーション」カテゴリのメールで、1年以上前のものを整理したい`
* `このスレッドの議論の流れを3行でまとめて`
* `至急対応が必要そうなメールがないかチェックして`

### 🗓️ Calendar：スケジュール調整
* `来週の空いている時間を30分単位で洗い出して`
* `明日の14時から1時間、「開発定例」という予定を入れて`
* `今日の予定で、移動時間を含めると被ってしまっている場所はある？`
* `今週の空いている隙間に、毎日30分の「集中タイム」を確保して`
* `今日の15時のミーティングを、明日の同じ時間にずらして`
* `次のミーティングの参加者と場所（URL）を教えて`
* `来月の祝日と、自分の予定が被っていないか確認して`

### 📂 Drive：資料検索と整理
* `ファイル名に「企画書」が含まれるドキュメントを全部探して`
* `「共有済み」フォルダの中にある、最近更新されたファイルはどれ？`
* `このファイルのアクセス権限を確認して、社外の人が見れるか教えて`
* `先週作成したスライド資料が見当たらないから探して`
* `ドライブ内の容量が大きいファイルを上位5つ教えて`
* `プロジェクトAのフォルダ構造と中身のファイル一覧をツリー形式で出して`
* `PDFファイルだけをフィルタリングして一覧にして`

### 📊 Sheets / Docs / Slides：ドキュメント活用
* `このスプレッドシートの売上データを読み込んで、傾向を分析して`
* `議事録のドキュメントをPDFに変換して、ローカルにダウンロードして`
* `来週のプレゼン用に、スライドの構成案とタイトルの下書きを作って`
* `スプレッドシートのA列にあるリストを読み上げて`
* `ドキュメントの誤字脱字チェックをして、修正箇所を指摘して`
* `特定のキーワードが含まれているスライドのページ数を教えて`
* `CSVファイルをスプレッドシートとしてインポートして`

### 👥 Contacts / People：連絡先管理
* `田中さんのメールアドレスと、所属部署を教えて`
* `連絡先に登録されている「株式会社〇〇」の人を全員リストアップして`
* `最近連絡をとった人のリストを表示して`
* `連絡先の中で、メールアドレスが登録されていない人はいる？`
* `「営業部」というラベルがついている人の連絡先を教えて`
* `今月誕生日の人がいたら教えて`
* `重複している連絡先がないかチェックして`

### ✅ Tasks：タスク管理
* `今日の未完了タスクを優先度順に教えて`
* `「牛乳を買う」「振込をする」をタスクリストに追加しておいて`
* `期限切れ（Overdue）のタスクを全て今日の日付にリスケジュールして`
* `完了済みのタスクを一括でクリア（削除）して`
* `このメールの内容を元に、やるべきことをタスク化して`
* `来週締め切りのタスクだけを抽出して教えて`
* `「買い物リスト」という新しいタスクリストを作って`

## 前提条件
* Google アカウントを持っていること
* ターミナル操作（基本的なコマンド入力）ができること
* `gog` コマンド自体はインストール済みであること
  * インストール方法は [公式サイト](https://gogcli.sh/) を参照（例: `brew install gogcli` 等）

## 手順 1: Google Cloud プロジェクトの作成

まず、`gog` が Google API にアクセスするための「場所（プロジェクト）」を作ります。

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセスし、ログインします。
2. 画面上部のプロジェクト選択メニューから **「新しいプロジェクト」** を作成します。
    * プロジェクト名: `gog-cli` （任意でOK）
3. プロジェクトが作成されたら、通知アイコンなどからそのプロジェクトを選択した状態にします。

## 手順 2: 必要な API の有効化

利用したいサービスの API を有効にします。これを行わないと、CLI からアクセスしても拒否されます。

1. メニューから **「APIとサービス」＞「ライブラリ」** を選択します。
2. 以下のキーワードで検索し、それぞれ **「有効にする」** をクリックします。
    * `Gmail API`
    * `Google Calendar API`
    * `Google Drive API`
    * （必要に応じて Sheets API 等も同様に追加可能です）

## 手順 3: OAuth 同意画面とテストユーザーの設定

UI変更されることがあります。2026-01-29 時点では以下の手順で設定できました。

1. **「APIとサービス」＞「OAuth 同意画面」** に移動します。
2. **User Type** で **「外部 (External)」** を選択し、「作成」をクリック。
3. **アプリ情報** を入力（必須項目のみでOK）。
    * アプリ名: `gog-cli`
    * ユーザーサポートメール: 自分のメールアドレス
    * デベロッパーの連絡先: 自分のメールアドレス
4. 「保存して次へ」で進みます。「スコープ」設定も変更せず「保存して次へ」。
5. **テストユーザーの登録**
    * ここで **必ず自分の Google アカウントを追加** してください。
    * **【注意】** 画面内に「テストユーザー」の設定項目が見当たらない場合は、左側のサイドメニューにある **「対象 (Audience)」** という項目をクリックしてください。そこに「テストユーザー (Test users)」セクションがあります。

## 手順 4: 認証情報 (client_secret) の取得

`gog` に渡すための「鍵」を発行します。

1. **「APIとサービス」＞「認証情報」** に移動します。
2. 画面上部の **「認証情報を作成」＞「OAuth クライアント ID」** を選択。
3. **アプリケーションの種類** で **「デスクトップ アプリ」** を選択。
4. 名前を付けて「作成」。
5. 作成完了後、一覧の右側にあるダウンロードアイコンから **JSONファイルをダウンロード** します。

## 手順 5: JSONファイルの配置

ダウンロードした JSON ファイルは、安全かつ管理しやすい場所に移動させます。

```bash:terminal
# 設定用ディレクトリの作成
mkdir -p ~/.config/gog

# ファイルの移動とリネーム（ファイル名はダウンロードしたものに合わせてください）
mv ~/Downloads/client_secret_xxxxx.json ~/.config/gog/credentials.json

# パーミッションの変更（自分だけが読み書きできるように制限）
chmod 600 ~/.config/gog/credentials.json
```

## 手順 6: gog への認証情報の登録とログイン

ここからターミナルでの操作です。

**1. クライアント情報の登録**

```bash:terminal
gog auth credentials ~/.config/gog/credentials.json
```

**2. アカウントのログイン**
以下のコマンドを実行するとブラウザが起動します。

```bash:terminal
gog auth add your-email@gmail.com
```

:::message alert
**ブラウザ認証の注意点**
コマンド実行後、ブラウザでの操作に時間をかけすぎると、ターミナル側がタイムアウトして `connection refused` エラーになります。エラーが出た場合は、もう一度コマンドを実行し、**素早く** 以下の操作を行ってください。
:::

* アカウントを選択（手順3で登録したテストユーザーのアカウント）。
* 「このアプリは Google で確認されていません」という警告が出たら、迷わず **「続行」** をクリック。
* 「gog-cli がアクセスを求めています」画面で **「すべて選択」** にチェックを入れて「続行」。

ブラウザに `You're connected` と表示されれば成功です。

**3. macOS の場合: キーチェーンの許可**
Mac では認証直後に「gogがキーチェーンを使用しようとしています」というポップアップが出ます。Macのログインパスワードを入力し、**「常に許可」** を選択してください。これで次回以降の入力が不要になります。

## 手順 7: 環境変数の設定と動作確認

設定しなくても動きましたが、環境変数を設定しておくと良いとのこと。

```bash:.zshrc / .bashrc
# デフォルトアカウントの設定（追記推奨）
export GOG_ACCOUNT=your-email@gmail.com
```

最後に動作確認を行います。

```bash:terminal
gog gmail labels list
gog drive list --limit 5
```

これが表示されればセットアップは完了です！

![セットアップ完了画面](/images/gog-cli-setup-guide/02.jpg)

## 対話で操作するエージェントスキルの導入

AIエージェントから使えるようにするために、Skills Marketplace で公開されている `gog` スキルをダウンロードしてインストールします。(同様のものがいくつかありますが、最も人気のあるものを選択しました。)

[gog - SkillsMP](https://skillsmp.com/skills/moltbot-moltbot-skills-gog-skill-md)

サイドバーの "wget skill.zip" ボタンからダウンロードして解凍。Claude Code なら、`~/.claude/skills/gog` に配置します。

この Skill には、AI が `gog` コマンドを叩く際の最適な引数定義や、エラー時のリカバリ手順があらかじめパッケージングされています。

これで、あなたのターミナルは Google サービス群を会話ベースで操作できる状態になりました👍
試しに `gog gmail labels list` を実行してみましょう。

### Tips

* 初めて使用する際は、許可ダイアログを押さえる必要があります
* 確実に gog を使用させたい場合は `gog スキルを使って` と指示
* Googleサービスを使うためのプロジェクトを作成しておき、カスタム指示に関連の指示を仕込むのもいいかも

---

---

（以下、使用には差し支えないので興味のない人は読む必要がないです）

## メモ: コマンドについて

:::message
**コマンドの癖に注意**
サービスごとに微妙に構文が違います。
* Drive: `gog drive list` (`list` が必要)
* Calendar: `gog calendar events` (`list` は省略する。つけるとエラーになる)
迷ったら `gog calendar events --help` のようにヘルプを確認するのが確実です。
:::

### Gmail：メールの検索・送信

未読チェックや、特定の条件でのメール抽出が行えます。

```bash:未読メールをチェック
gog gmail search "is:unread" --limit 10
```

```bash:特定のメールを検索（AI用：JSON出力）
# 「先週の請求書を探して」といった指示に対応させる場合
# --json で詳細情報を取得するのがコツです
gog gmail search "newer_than:7d subject:invoice" --json
```

```bash:メールを送信
# パイプを使えば、生成したテキストをそのままメール本文に流し込めます
echo "会議の資料です。" | gog gmail send --to "user@example.com" --subject "資料送付" --body-file -
```

### Calendar：予定の確認・追加

カレンダー操作は `events` サブコマンドを使います。`list` を省略するのがコツです。

```bash:今日の予定を確認
gog calendar events --today
```

```bash:予定を追加する
# 「明日の14時にMTGを入れて」と頼まれたら
gog calendar create --summary "開発定例" --start "tomorrow 14:00" --duration 1h
```

### Drive：ファイルの検索・操作

GUIでは面倒な検索も、CLIなら正規表現やクエリで一発です。

```bash:ファイルを検索
gog drive search "name contains '報告書'"
```

```bash:ファイルをダウンロード
# 検索で見つけたファイルIDを指定して手元に落とします
gog drive download <fileId>
```

## AIエージェント開発のヒント

AI に `gog` を使わせる際は、出力形式を制御する **`--json` オプション** が鍵になります。

* **人間用:** `gog calendar events --today` （視認性の高い表形式）
* **AI用:** `gog calendar events --today --json` （解析しやすいJSON形式）

コマンド結果（JSON）を読み取らせ、次の行動を自律的に判断させる——このループを構築することで、AIは単なるチャットボットから、スケジュール調整や資料探しを代行する「真のエージェント」へと進化します。
